# Microsoft To-Do Import API Tests for VS Code REST Client
# Install "REST Client" extension in VS Code to run these

### Variables
@baseUrl = http://localhost:3000
@authToken = test-token-123

### 1. Health Check (Basic test)
GET {{baseUrl}}/api/health
Content-Type: application/json

### 2. Test Import Routes - Get Connections
GET {{baseUrl}}/api/import/connections
Authorization: Bearer {{authToken}}
Content-Type: application/json

### 3. Start Microsoft OAuth Flow
POST {{baseUrl}}/api/import/auth/microsoft/initiate
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "returnUrl": "http://localhost:3000/import-success"
}

### 4. Start Import Session
POST {{baseUrl}}/api/import/start
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "provider": "microsoft",
  "options": {
    "includeCompletedTasks": false,
    "dueDateFilter": {
      "after": "2024-01-01",
      "before": "2025-12-31"
    }
  }
}

### 5. Test with cURL commands (copy these to terminal if REST Client doesn't work):
# curl -X GET "http://localhost:3000/api/health"
# curl -X GET "http://localhost:3000/api/import/connections" -H "Authorization: Bearer test-token-123"
# curl -X POST "http://localhost:3000/api/import/start" -H "Authorization: Bearer test-token-123" -H "Content-Type: application/json" -d '{"provider": "microsoft"}'
